---
title: "R Notebook"
output: html_notebook
---

ANALISI DATASET neuroblastoma.csv

Algoritmo di clustering: K-means

Iperparametri:

-   k=2

-   k=3

-   k=5

```{r}
library(UniversalCVI)
library(readr)

# Lettura e pulizia del dataset da dati NA
dataset <- na.omit(read.csv("~/Calinski_Harabasz_Thesis/Data/DatasetReali/10_7717_peerj_5665_dataYM2018_neuroblastoma.csv"))

# Clustering con K-means e validazione del clustering con CH.IDX
df <- CH.IDX(dataset, 5)

# Stampa risultati
cat(sprintf("\nIndice Calinski-Harabasz per k=2: %f\n",df[1,2] ))

cat(sprintf("\nIndice Calinski-Harabasz per k=3: %f\n",df[2,2] ))

cat(sprintf("\nIndice Calinski-Harabasz per k=5: %f\n",df[4,2] ))

```

Quindi verifichiamo che applicando l'algoritmo di clustering K-means, la metrica di Calinski-Harabasz individua come miglior configurazione quella con il valore di k=5 rispetto a quelle scelte.

Algoritmo di clustering: DBSCAN

Iperparametri:

-   𝜀=2 , minPts= 3

-   𝜀=2 , minPts= 4

-   𝜀=1.5 , minPts= 3

```{r}
library(dbscan)
library(fpc)

# Creazione dataframe iterazioni/valore
risultati <- data.frame(caso = integer(), valore = numeric(),
                        stringsAsFactors = FALSE)

# Clustering con DBSCAN con eps=2 e minPts=3
clustering <- dbscan(dataset, 2, 3)

risultati <- rbind(risultati, data.frame(caso=1, valore=calinhara(dataset, clustering$cluster)))

# Stampa risultato
cat(sprintf("\nIndice Calinski-Harabasz per eps=2 e minPts=3: %f\n",risultati[1,2] ))

# Clustering con DBSCAN con eps=2 e minPts=4
clustering <- dbscan(dataset, 2, 4)

risultati <- rbind(risultati, data.frame(caso=2, valore=calinhara(dataset, clustering$cluster)))

# Stampa risultato
cat(sprintf("\nIndice Calinski-Harabasz per eps=2 e minPts=4: %f\n",risultati[2,2] ))

# Clustering con DBSCAN con eps=1.5 e minPts=3
clustering <- dbscan(dataset, 1.5, 3)

risultati <- rbind(risultati, data.frame(caso=3, valore=calinhara(dataset, clustering$cluster)))

# Stampa risultato
cat(sprintf("\nIndice Calinski-Harabasz per eps=1.5 e minPts=3: %f\n",risultati[3,2] ))

```

Quindi verifichiamo che applicando l'algoritmo di clustering DBSCAN, la metrica di Calinski-Harabasz individua come miglior configurazione quella con i valori di 𝜀=1.5 e minPts= 3 rispetto a quelle scelte.

Algoritmo di clustering: Hierarchical clustering

Iperparametri:

-   complete-linkage

-   average-linkage

-   single-linkage

```{r}

# Clustering con complete-linkage e validazione del clustering con CH.IDX
cmplt_link <- CH.IDX(dataset, 10, 2, "hclust_complete")

# Stampa risultati
cat(sprintf("\nIndice Calinski-Harabasz per complete-linkage: \n"))
print(cmplt_link)

# Clustering con average-linkage e validazione del clustering con CH.IDX
avrg_link <- CH.IDX(dataset, 10, 2, "hclust_average")

# Stampa risultati
cat(sprintf("\nIndice Calinski-Harabasz per average-linkage: \n"))
avrg_link

# Clustering con single-linkage e validazione del clustering con CH.IDX
sngl_link <- CH.IDX(dataset, 10, 2, "hclust_single")

# Stampa risultati
cat(sprintf("\nIndice Calinski-Harabasz per single-linkage: \n"))
sngl_link
```

Quindi verifichiamo che applicando l'algoritmo di clustering Hierarchical clustering, la metrica di Calinski-Harabasz individua come miglior configurazione quella con tipo complete-linkage rispetto alle altre opzioni.

CONCLUSIONI:

L'analisi effettuata tramite la metrica di Calinski-Harabasz indica come miglior risultato la combinazione di DBSCAN come algoritmo di clustering con configurazione di iperparametri 𝜀=1.5 e minPts= 3.
